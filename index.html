<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>PIX API - Banco BV</title>

  <link rel="stylesheet" href="https://unpkg.com/swagger-ui-dist/swagger-ui.css" />

  <style>
    html, body {
      margin: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      background: #f5f7fa;
    }

    .layout {
      display: grid;
      grid-template-columns: 300px 1fr 520px;
      height: 100vh;
    }

    /* Sidebar */
    .sidebar {
      background: #fff;
      border-right: 1px solid #ddd;
      padding: 16px;
      overflow-y: auto;
    }

    .sidebar h3 {
      font-size: 14px;
      color: #002f6c;
      margin-bottom: 10px;
    }

    .sidebar li {
      font-size: 13px;
      padding: 6px 8px;
      cursor: pointer;
      border-radius: 4px;
    }

    .sidebar li:hover {
      background: rgba(0,47,108,.1);
    }

    /* Conteúdo central */
    .content {
      background: #fff;
      overflow-y: auto;
    }

    .swagger-ui {
      padding: 20px;
    }

    /* Painel direito */
    .code-panel {
      background: #0b1220;
      border-left: 1px solid #ddd;
      overflow-y: auto;
      padding: 16px;
    }

    /* Ajustes visuais do Swagger clonado */
    .code-panel .swagger-ui {
      background: transparent;
      padding: 0;
    }

    .code-panel .opblock {
      margin-bottom: 24px;
      box-shadow: none;
      border: none;
    }

    .code-panel .opblock-summary {
      pointer-events: none;
    }

    .code-panel pre {
      background: #020617 !important;
    }

    @media (max-width: 1200px) {
      .layout {
        grid-template-columns: 260px 1fr;
      }
      .code-panel {
        display: none;
      }
    }
  </style>
</head>

<body>
<div class="layout">

  <!-- Sidebar -->
  <aside class="sidebar">
    <h3>Documentação</h3>
    <ul id="sidebar-menu"></ul>
    <hr />
    <small>
      Open Banking<br />
      <strong>openbanking@bv.com.br</strong>
    </small>
  </aside>

  <!-- Conteúdo -->
  <main class="content">
    <div id="swagger-ui"></div>
  </main>

  <!-- Painel de código -->
  <aside class="code-panel">
    <div id="code-view"></div>
  </aside>

</div>

<script src="https://unpkg.com/swagger-ui-dist/swagger-ui-bundle.js"></script>

<script>
  SwaggerUIBundle({
    url: "https://camargofe.github.io/LwcDocumentacaoAPI/pix.yaml",
    dom_id: "#swagger-ui",
    layout: "BaseLayout"
  });

  setTimeout(initSync, 2000);

  function initSync() {
    buildSidebar();
    bindEndpointClick();
  }

  function buildSidebar() {
    const menu = document.getElementById("sidebar-menu");
    document.querySelectorAll(".opblock-tag").forEach(tag => {
      const title = tag.querySelector("h3 span");
      if (!title) return;

      const li = document.createElement("li");
      li.textContent = title.textContent.trim();
      li.onclick = () => tag.scrollIntoView({ behavior: "smooth" });
      menu.appendChild(li);
    });
  }

  function bindEndpointClick() {
    document.querySelectorAll(".opblock-summary").forEach(summary => {
      summary.addEventListener("click", () => {
        setTimeout(renderRightPanel, 300);
      });
    });
  }

  function renderRightPanel() {
    const panel = document.getElementById("code-view");
    panel.innerHTML = "";

    const active = document.querySelector(".opblock.is-open");
    if (!active) return;

    const clone = active.cloneNode(true);

    // Remove try-out e botões desnecessários
    clone.querySelectorAll(".try-out, button").forEach(b => b.remove());

    const wrapper = document.createElement("div");
    wrapper.className = "swagger-ui";
    wrapper.appendChild(clone);

    panel.appendChild(wrapper);
  }
</script>

</body>
</html>
